<html>
 <head>
  <meta charset="UTF-8">
  <title>WaveDrom Editor</title>
  <link rel="shortcut icon" href="images/favicon.ico"/>
  <link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="css/codemirror.css">
  <link rel="stylesheet" href="css/dialog.css">
  <link rel="stylesheet" href="css/main.css">

  <script src="scripts/codemirror-compressed.js"></script>
  <script src="scripts/lodash.min.js"></script>
  <script src="skins/default.js"></script>
  <script src="skins/narrow.js"></script>
  <script src="WaveDrom.js"></script>
  <script src="editor.js"></script>
</head>

  <body onload="editorInit()" onclick="menuOpen(event)">
    <div id="content">
      <div class="toolbar">
        <img class="button" alt="Memu" id="Menu" title="Menu" src="images/ic_menu.png"/>
      </div>
      <div style="display:none;" class="menu" id="menux">
        <ul>
          <!--li>New</li>
          <li>Open...</li>
          <li>Save</li-->
          <li onclick="saveJSON(event)"> <img class="button" src="images/ic_download_json.png"/> Save As... </li>
          <li onclick="saveSVG(event)"> <img class="button" src="images/ic_download_svg.png"/> Export SVG... </li>
          <li onclick="savePNG(event)"> <img class="button" src="images/ic_download_png.png"/> Export PNG... </li>
        </ul>
        <ul>
          <li onclick="editorState({rot:1})"> <img class="button" src="images/ic_rot.png" /> Rotate Layout </li>
          <li onclick="editorState({per:1})"> <img class="button" src="images/ic_persent.png" /> Proportions </li>
          <li onclick="setFullURL()"> <img class="button" src="images/ic_url.png"/> Expand URL </li>
          <li onclick="gotoWaveDromGuide()" id="WaveDromGuide"> <img class="button" src="images/ic_guide.png"/> WaveDrom Guide </li>
          <li onclick="gotoWaveDromHome()"  id="WaveDromHome"> <img class="button" src="images/ic_logo.png"/> on GitHub </li>
          <li style="display:none;">Exit</li>
        </ul>
      </div>
      <input style="display:none;" id="fileDialog" type="file" nwsaveas="wavedrom.json" />
      <input style="display:none;" id="fileDialogSVG" type="file" nwsaveas="wavedrom.svg" />
      <input style="display:none;" id="fileDialogPNG" type="file" nwsaveas="wavedrom.png" />
      <div id='SVG'><div id="WaveDrom_Display_0"></div></div>
      <div id='TXT'><textarea id="InputJSON_0"></textarea></div>
    </div>
  <script type="text/javascript">
    (function KillBill () {
      if (navigator.appName.indexOf('Explorer') >= 0) {
        var e = document.getElementById('content');
        e.parentNode.removeChild(e);
        document.write("<h1>Sorry, Internet Explorer is not supported.</h1>");
        document.body.style.backgroundColor = '#ffdddd';
        window.stop();
      }
    })();
  </script>
  <script>
    var e, val, timer, isNodeWebkit;
    e = document.getElementById ('InputJSON_0');
    val = localStorage ['waveform'];
            // node-webkit detection
    isNodeWebkit = (typeof process == "object");

    if (isNodeWebkit || val === undefined || val === '') {
        val = "{signal: [\n  {name: 'clk', wave: 'p.....|...'},\n  {name: 'dat', wave: 'x.345x|=.x', data: ['head', 'body', 'tail', 'data']},\n  {name: 'req', wave: '0.1..0|1.0'},\n  {},\n  {name: 'ack', wave: '1.....|01.'}\n]}\n";
        localStorage ['waveform'] = val;
    }
    e.value = val;
    var cm = CodeMirror.fromTextArea (e, {lineNumbers: true, mode: {name: 'javascript', json: true}, matchBrackets: true, autoCloseBrackets: true, highlightSelectionMatche: true, autofocus: true});
    cm.on ("change", function (cm, change) {
        function c () {
            var v = cm.getValue();
            e.value = v;
            localStorage ['waveform'] = v;
            WaveDrom.EditorRefresh ();
        }
        timer = setTimeout (c, 750);
    });
  </script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-21660728-3', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>
